CREATE DATABASE techcorp2;
USE techcorp;

-- Creación de la tabla de departamentos
CREATE TABLE departments1 (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(50) NOT NULL
);

-- Creación de la tabla de empleados con la clave foránea a departamentos
CREATE TABLE employees2 (
    id INT AUTO_INCREMENT PRIMARY KEY,
    first_name VARCHAR(50) NOT NULL,
    last_name VARCHAR(50) NOT NULL,
    age INT NOT NULL,
    salary DECIMAL(10,2) NOT NULL,
    hire_date DATE NOT NULL,
    department_id INT,
    FOREIGN KEY (department_id) REFERENCES departments(id) ON DELETE SET NULL ON UPDATE CASCADE
);

-- Inserción de datos en la tabla de departamentos
INSERT INTO departments (name) VALUES ('IT'), ('Ventas'), ('Recursos Humanos'), ('Finanzas'), ('Marketing');

-- Inserción de datos en la tabla de empleados
INSERT INTO employees (first_name, last_name, age, salary, hire_date, department_id) VALUES
('Ana', 'Gomez', 28, 3500.00, '2019-06-15', 1),
('Carlos', 'Martinez', 34, 4200.00, '2018-04-10', 2),
('Beatriz', 'Lopez', 40, 3800.00, '2021-07-22', 3),
('David', 'Fernandez', 45, 5000.00, '2015-09-30', 4),
('Elena', 'Ruiz', 29, 3100.00, '2022-02-14', 5),
('Fernando', 'Sanchez', 38, 4500.00, '2017-12-05', 2),
('Gabriela', 'Torres', 32, 2900.00, '2023-01-08', 1),
('Hugo', 'Diaz', 41, 5200.00, '2014-06-20', 4),
('Isabel', 'Ramirez', 35, 4100.00, '2019-11-25', 3),
('Javier', 'Castro', 30, 2800.00, '2021-09-12', 5);

-- Consulta: 1. Lista de empleados: Obtén los nombres, edades y salarios de todos los empleados
SELECT first_name, last_name, age, salary FROM employees;

-- Consulta: 2. Altos ingresos: ¿Quiénes son los empleados que ganan más de $4,000?
SELECT first_name, last_name, salary FROM employees WHERE salary > 4000;

-- Consulta: 3. Fuerza de ventas: Extrae la lista de empleados que trabajan en el departamento de Ventas
SELECT e.first_name, e.last_name FROM employees e
JOIN departments d ON e.department_id = d.id
WHERE d.name = 'Ventas';

-- Consulta: 4. Rango de edad: Encuentra a los empleados que tienen entre 30 y 40 años
SELECT first_name, last_name, age FROM employees WHERE age BETWEEN 30 AND 40;

-- Consulta: 5. Nuevas contrataciones: ¿Quiénes han sido contratados después del año 2020?
SELECT first_name, last_name, hire_date FROM employees WHERE YEAR(hire_date) > 2020;

-- Consulta: 6. Distribución de empleados: ¿Cuántos empleados hay en cada departamento?
SELECT d.name AS department, COUNT(e.id) AS num_employees
FROM employees e
JOIN departments d ON e.department_id = d.id
GROUP BY d.name;

-- Consulta: 7. Análisis salarial: ¿Cuál es el salario promedio en la empresa?
SELECT AVG(salary) AS average_salary FROM employees;

-- Consulta: 8. Nombres selectivos: Muestra los empleados cuyos nombres comienzan con "A" o "C"
SELECT first_name, last_name FROM employees WHERE first_name LIKE 'A%' OR first_name LIKE 'C%';

-- Consulta: 9. Departamentos específicos: Encuentra a los empleados que no pertenecen al departamento de IT
SELECT e.first_name, e.last_name FROM employees e
JOIN departments d ON e.department_id = d.id
WHERE d.name <> 'IT';

-- Consulta: 10. El mejor pagado: ¿Quién es el empleado con el salario más alto?
SELECT first_name, last_name, salary FROM employees ORDER BY salary DESC LIMIT 1;
